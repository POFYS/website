---
import Layout from '../components/Layout.astro';

let _type: string | null = null;
if (Astro.url && Astro.url.searchParams && typeof Astro.url.searchParams.get === 'function') {
  _type = Astro.url.searchParams.get('type');
} else {
  try {
    const rawSearch = (Astro.url && (Astro.url.search || Astro.url.href || '')) || '';
    const query = rawSearch.includes('?') ? rawSearch.split('?').slice(1).join('?') : rawSearch;
    const params = new URLSearchParams(query);
    _type = params.get('type');
  } catch (e) {
    _type = null;
  }
}
const type = _type || 'article';
const isArabic = Astro.url.pathname.startsWith('/ar');

const labels: Record<string, any> = {
  article: {
    title: 'Article not available',
    description: "This article isn't available in the selected language",
    primary: 'Back to English articles',
    secondary: 'Browse Arabic articles',
    primaryHref: '/articles',
    secondaryHref: '/ar/articles'
  },
  communique: {
    title: 'Communique not available',
    description: "This communique isn't available in the selected language",
    primary: 'Back to English communiques',
    secondary: 'Browse Arabic communiques',
    primaryHref: '/communiques',
    secondaryHref: '/ar/communiques'
  }
};

const key = (type === 'communique' || type === 'communiques') ? 'communique' : 'article';
const current = labels[key];
---

<Layout title={current.title} description={current.description}>
  <div class="unavailable-page" lang={isArabic ? 'ar' : 'en'} dir={isArabic ? 'rtl' : 'ltr'}>
    <header class="page-header">
      <h1>{current.title}</h1>
      <p>{current.description}</p>
    </header>

    <div class="actions">
      <a href={current.primaryHref} class="btn">{current.primary}</a>
      <a href={current.secondaryHref} class="btn secondary">{current.secondary}</a>
    </div>
  </div>
</Layout>

<style>
  .unavailable-page {
    max-width: 680px;
    margin: 4rem auto;
    text-align: center;
  }

  .page-header h1 {
    font-size: 2rem;
    margin-bottom: 0.5rem;
  }

  .page-header p {
    color: var(--color-text-secondary);
    margin-bottom: 1.5rem;
  }

  .actions {
    display: flex;
    gap: 1rem;
    justify-content: center;
    margin-top: 1.5rem;
    flex-wrap: wrap;
  }

  .btn {
    display: inline-block;
    padding: 0.75rem 1.25rem;
    background: var(--color-accent);
    color: white;
    text-decoration: none;
    border-radius: 6px;
    font-weight: 700;
  }

  .btn.secondary {
    background: transparent;
    color: var(--color-text-primary);
    border: 2px solid var(--color-border);
  }
</style>
